# NC财务智能问数系统 - 工作任务清单

> 跟踪所有配置和开发工作的进度
>
> 📚 [实施方案](./NC_财务智能问数系统_实施方案.md) | [SQLBot官方文档](https://dataease.cn/sqlbot/v1/)

---

## 方案选择

- [x] **✅ 已确认采用方案 A（视图预处理）**

> 方案A优势：dr=0、vouchstatus>=3 等规则固化在视图中，配置更简单，准确度更稳定。

---

## 一、P0 配置（必须完成）

### 数据访问与连接

- [ ] **CFG-P0-01: 数据访问与安全基线** (1天)
  - [ ] 创建只读数据库账号
  - [ ] 配置访问权限与白名单
  - [ ] 明确审计规则

- [ ] **CFG-P0-02: 数据源连接与元数据同步** (1天)
  - [ ] 在 SQLBot 创建数据源
  - [ ] 方案A: 同步视图 / 方案B: 同步核心表
  - [ ] 验证连接成功

### 表与字段配置

- [ ] **CFG-P0-03: 表/字段描述与别名** (1天)
  - [ ] 为核心表/视图添加业务描述
  - [ ] 设置关键字段别名
  - [ ] 添加枚举值说明

- [ ] **CFG-P0-04: 表关系管理** (0.5天)
  - [ ] 方案A: 维护视图间关系
  - [ ] 方案B: 维护核心表关系

### 知识库建设

- [ ] **CFG-P0-05: 术语库建设** (2天)
  - [ ] 基于 `NC_财务术语库_配置模板.md` 整理
  - [ ] 录入 30+ 术语
  - [ ] 验证检索效果

- [ ] **CFG-P0-06: SQL示例库建设** (2天)
  - [ ] 基于 `NC_财务SQL示例库_配置模板.md` 整理
  - [ ] 录入 50+ 示例
  - [ ] 验证检索效果

### 权限与系统配置

- [ ] **CFG-P0-07: 权限与安全配置** (1天)
  - [ ] 创建规则组
  - [ ] 配置行级权限（组织隔离）
  - [ ] 配置列级权限（字段脱敏）

- [ ] **CFG-P0-08: AI模型配置** (0.5天)
  - [ ] 添加 AI 模型
  - [ ] 设置模型参数
  - [ ] 验证可调用

- [ ] **CFG-P0-09: 用户与工作空间配置** (0.5天)
  - [ ] 创建用户/角色
  - [ ] 分配到工作空间
  - [ ] 验证隔离生效

### 测试验证

- [ ] **CFG-P0-10: 测试验证与调优** (3天)
  - [ ] 设计 20+ 测试场景
  - [ ] 执行测试并记录结果
  - [ ] 补齐术语/示例/描述
  - [ ] 达到首次正确率 > 80%

---

## 二、P0 开发（必须）

- [ ] **DEV-P0-01: SQL护栏与规则重写** (2天) - 方案B必需
  - [ ] 实现 dr=0 自动注入
  - [ ] 实现 vouchstatus/billstatus 过滤
  - [ ] 集成到 LLMService

- [ ] **DEV-P0-02: 主题域/表分组** (1天)
  - [ ] 设计表分组方案
  - [ ] 实现检索收敛

- [ ] **DEV-P0-03: NC Starter Pack 一键导入** (1天)
  - [ ] 打包术语/示例/规则
  - [ ] 编写导入脚本

- [ ] **DEV-P0-04: 自定义提示词兜底** (1天) - X-Pack不可用时
  - [ ] 实现提示词存储
  - [ ] 实现提示词注入链路

- [ ] **DEV-P0-05: 视图开发脚本** (2天) - 方案A
  - [ ] 设计凭证明细视图
  - [ ] 设计科目余额视图
  - [ ] 设计应收账款视图
  - [ ] 设计固定资产视图
  - [ ] 由DBA创建并授权

---

## 三、P1 配置（尽量完成）

- [ ] **CFG-P1-01: 术语与示例扩展** (2天)
- [ ] **CFG-P1-02: 新手问题模板库** (1天)
- [ ] **CFG-P1-03: 评测集与周度复盘** (2天)

---

## 四、P1 开发（尽量完成）

- [ ] **DEV-P1-01: 预置财务问题模板** (2天)
- [ ] **DEV-P1-02: 组织切换优化** (2天)
- [ ] **DEV-P1-03: 会计期间智能识别** (2天)
- [ ] **DEV-P1-04: 性能优化** (1天)

---

## 五、P2（可选）

- [ ] 多组织对比模板
- [ ] 财务看板/报表模板
- [ ] 金额格式化与单位处理
- [ ] 科目编码智能补全

---

## 六、资料准备

### 数据库相关（P0）
- [ ] NC 数据库连接信息
- [ ] 只读账号与授权
- [ ] NC 版本确认

### 业务相关（P0）
- [ ] 常用科目清单
- [ ] 组织架构
- [ ] 常见财务问题清单（20+）

---

## 七、里程碑

| 阶段 | 时间 | 内容 | 状态 |
|:---|:---|:---|:---:|
| Phase A | T0 ~ T0+2周 | CFG-P0-01~09 + 方案设计 | ⏳ |
| Phase B | T0+2周 ~ 2025-02-10 | DEV-P0 + CFG-P0-10 + Starter Pack | ⏳ |
| Phase C | 2025-02-11 后 | P1/P2 持续优化 | ⏳ |

---

*最后更新: 2026-01-07*
